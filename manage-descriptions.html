---
layout: default
---

<div class="container mx-auto py-10 px-4">
  <h1 class="text-3xl font-bold mb-6">Manage Image Descriptions</h1>
  <p class="mb-8">Add or edit descriptions for your gallery images. These descriptions will appear next to the images when viewed in the lightbox gallery.</p>
  
  <div id="image-descriptions-editor" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
    <!-- Images will be dynamically loaded here -->
    <div class="text-center py-8">Loading images...</div>
  </div>
  
  <div class="mt-8 text-center">
    <button id="save-descriptions" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded">
      Save All Descriptions
    </button>
    <div id="save-status" class="mt-4 hidden"></div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const baseUrl = document.querySelector('meta[name="baseurl"]')?.content || '';
  const editorContainer = document.getElementById('image-descriptions-editor');
  const saveButton = document.getElementById('save-descriptions');
  const saveStatus = document.getElementById('save-status');
  let imageDescriptions = {};
  
  // Load existing descriptions
  fetch(baseUrl + '/images/image_descriptions.json')
    .then(response => response.json())
    .then(data => {
      imageDescriptions = data;
      loadImageEditor();
    })
    .catch(error => {
      console.error('Error loading image descriptions:', error);
      // If file doesn't exist yet, start with empty object
      loadImageEditor();
    });
  
  function loadImageEditor() {
    // First clear the loading message
    editorContainer.innerHTML = '';
    
    // Load all images from the fulls directory
    fetch(baseUrl + '/images/fulls/')
      .then(response => response.text())
      .then(html => {
        // Create a temporary element to parse the HTML
        const tempDiv = document.createElement('div');
        tempDiv.innerHTML = html;
        
        // Find all image links
        const imageLinks = Array.from(tempDiv.querySelectorAll('a')).filter(a => 
          a.href.endsWith('.jpg') || a.href.endsWith('.jpeg') || a.href.endsWith('.png')
        );
        
        if (imageLinks.length === 0) {
          editorContainer.innerHTML = '<div class="col-span-full text-center py-8">No images found. Make sure you have images in the fulls directory.</div>';
          return;
        }
        
        // Create editor cards for each image
        imageLinks.forEach(link => {
          const imageName = link.href.split('/').pop();
          const imagePath = baseUrl + '/images/thumbs/' + imageName;
          
          // Get existing description or create empty one
          const imageData = imageDescriptions[imageName] || { title: '', description: '' };
          
          // Create editor card
          const card = document.createElement('div');
          card.className = 'border rounded-lg overflow-hidden bg-white dark:bg-gray-800';
          card.dataset.imageName = imageName;
          
          card.innerHTML = `
            <div class="aspect-w-4 aspect-h-3 bg-gray-100">
              <img src="${imagePath}" alt="${imageName}" class="object-cover w-full h-48"/>
            </div>
            <div class="p-4">
              <p class="text-xs text-gray-500 mb-2">${imageName}</p>
              <div class="mb-3">
                <label class="block text-sm font-medium mb-1">Title:</label>
                <input type="text" class="image-title w-full px-3 py-2 border rounded" 
                  value="${imageData.title || ''}" placeholder="Image title">
              </div>
              <div>
                <label class="block text-sm font-medium mb-1">Description:</label>
                <textarea class="image-description w-full px-3 py-2 border rounded" 
                  rows="3" placeholder="Image description">${imageData.description || ''}</textarea>
              </div>
            </div>
          `;
          
          editorContainer.appendChild(card);
        });
      })
      .catch(error => {
        console.error('Error loading images:', error);
        editorContainer.innerHTML = '<div class="col-span-full text-center py-8">Error loading images. Please check the console for details.</div>';
      });
  }
  
  // Save button handler
  saveButton.addEventListener('click', function() {
    // Collect all description data
    const cards = document.querySelectorAll('#image-descriptions-editor > div');
    cards.forEach(card => {
      const imageName = card.dataset.imageName;
      if (!imageName) return;
      
      const titleInput = card.querySelector('.image-title');
      const descriptionTextarea = card.querySelector('.image-description');
      
      if (titleInput && descriptionTextarea) {
        imageDescriptions[imageName] = {
          title: titleInput.value.trim(),
          description: descriptionTextarea.value.trim()
        };
      }
    });
    
    // In a real-world scenario, you would make an AJAX request to save the data
    // For this demo, we'll just show what would be saved
    saveStatus.innerHTML = `
      <div class="bg-green-100 border-l-4 border-green-500 text-green-700 p-4 mb-4">
        <p>Descriptions would be saved in a real-world scenario. Here's the data that would be saved:</p>
      </div>
      <div class="bg-gray-100 p-4 rounded text-left overflow-auto max-h-96">
        <pre>${JSON.stringify(imageDescriptions, null, 2)}</pre>
      </div>
    `;
    saveStatus.classList.remove('hidden');
    
    // Scroll to the status message
    saveStatus.scrollIntoView({ behavior: 'smooth' });
  });
});
</script> 